WEBVTT

00:00:00.560 --> 00:00:01.760 align:middle
みなさん
こんにちは。

00:00:01.920 --> 00:00:05.280 align:middle
このコースでは
yourself メソッドについて学びます。

00:00:06.040 --> 00:00:10.520 align:middle
役に立たなさそうに見えますが
とても有用なメソッドです。

00:00:10.680 --> 00:00:12.280 align:middle
練習問題から始めましょう。

00:00:12.440 --> 00:00:16.480 align:middle
この表現式 Set new add: 2 を見てください。

00:00:18.320 --> 00:00:23.680 align:middle
値 2 を含む集合が欲しいのですが

00:00:23.840 --> 00:00:27.200 align:middle
この表現式は値 2 だけを返します。

00:00:27.360 --> 00:00:31.240 align:middle
どうして値 2 が得られるのでしょう？
2 を含む集合ではなく。

00:00:31.400 --> 00:00:34.880 align:middle
Set クラスに実装されている
add: メソッドを見れば

00:00:35.040 --> 00:00:37.800 align:middle
そのメソッドが引数を返り値として返す
ことがわかるでしょう。

00:00:42.320 --> 00:00:44.520 align:middle
表現式 Set new add: 2 では

00:00:46.160 --> 00:00:48.880 align:middle
表現式 Set は Set クラスを返します。

00:00:50.480 --> 00:00:54.960 align:middle
Set クラスに new を送ると
新しい集合が返ってきます。

00:00:55.960 --> 00:00:57.520 align:middle
Set new add: 2 は

00:00:57.680 --> 00:01:01.000 align:middle
add: 2 の返り値を返します。
つまり、2 です。

00:01:01.160 --> 00:01:02.720 align:middle
集合のほうは得られません。

00:01:02.880 --> 00:01:05.280 align:middle
この問題を解決するには

00:01:05.440 --> 00:01:09.000 align:middle
表現式をステップごとに分割して書くことができます。

00:01:09.840 --> 00:01:14.280 align:middle
一時変数をつくります。
変数 s を宣言します。

00:01:15.320 --> 00:01:18.920 align:middle
新しい集合を s に代入します。

00:01:19.720 --> 00:01:21.800 align:middle
s に 2 を追加(add:)します。

00:01:22.920 --> 00:01:28.480 align:middle
これで s は値 2 を含む集合を保持します。

00:01:28.640 --> 00:01:31.240 align:middle
これが欲しかったものです。

00:01:31.400 --> 00:01:33.920 align:middle
これらの表現式を

00:01:34.080 --> 00:01:36.440 align:middle
yourself メソッドを使って簡潔にできます。

00:01:36.600 --> 00:01:38.200 align:middle
yourself メソッドの中身を見ると

00:01:38.360 --> 00:01:42.960 align:middle
たった1つのことしかしません。
self を返すだけです。

00:01:43.120 --> 00:01:47.160 align:middle
self を返すことはメソッドのデフォルトなので省略可能です。
このメソッドは空でも良いのです。

00:01:47.320 --> 00:01:49.960 align:middle
何もしないのです。
レシーバーを返り値とすることを除いて。

00:01:50.920 --> 00:01:55.280 align:middle
このメソッドはそのレシーバーを返すだけですが

00:01:56.040 --> 00:01:59.680 align:middle
それでも有用です。

00:02:00.800 --> 00:02:03.400 align:middle
オペレーターカスケードを使うことで。

00:02:03.560 --> 00:02:05.360 align:middle
2 を追加した後で

00:02:05.520 --> 00:02:08.960 align:middle
yourself メソッドを実行しましょう。

00:02:09.120 --> 00:02:11.040 align:middle
するとレシーバーが返ってきます。

00:02:11.200 --> 00:02:14.360 align:middle
つまり表現式全体の値がレシーバーになります。

00:02:14.520 --> 00:02:17.560 align:middle
つまりこの新しい集合です。

00:02:18.480 --> 00:02:22.520 align:middle
Set new として

00:02:22.680 --> 00:02:24.000 align:middle
新しい集合を手にして

00:02:24.760 --> 00:02:28.600 align:middle
add: 2 を Set new に適用すると

00:02:28.760 --> 00:02:30.320 align:middle
2 が返ってきます。

00:02:30.480 --> 00:02:34.280 align:middle
しかしオペレーターカスケードを使って
yourself と続けることで

00:02:34.440 --> 00:02:39.240 align:middle
表現式全体はこの新しい集合を返します。

00:02:40.360 --> 00:02:43.240 align:middle
なぜ？

00:02:43.400 --> 00:02:45.760 align:middle
カスケードは最後の表現式が返した値を返す
仕掛けになっています。

00:02:46.600 --> 00:02:48.800 align:middle
このカスケードは

00:02:48.960 --> 00:02:52.840 align:middle
yourself が返す値を返します。

00:02:53.000 --> 00:02:56.960 align:middle
yourself はよくカスケードと一緒に

00:02:57.120 --> 00:03:00.120 align:middle
インスタンス生成のメソッドで使われます。

00:03:00.280 --> 00:03:04.840 align:middle
クラスに送られるメッセージに対応する

00:03:05.000 --> 00:03:07.280 align:middle
クラスメソッドで

00:03:07.440 --> 00:03:09.240 align:middle
新しいインスタンスを返します。

00:03:10.040 --> 00:03:12.360 align:middle
新しい Set を

00:03:12.520 --> 00:03:16.440 align:middle
ある要素を予め含めて生成する時には

00:03:16.600 --> 00:03:21.680 align:middle
Set に with: anObject メッセージを
送ります。

00:03:21.840 --> 00:03:25.520 align:middle
このコードは新しい集合を作って

00:03:25.680 --> 00:03:27.920 align:middle
変数 instance に格納して

00:03:28.680 --> 00:03:31.600 align:middle
引数を instance に追加して

00:03:31.760 --> 00:03:34.080 align:middle
instance を返り値とします。

00:03:34.240 --> 00:03:38.080 align:middle
この式全体を yourself を使って

00:03:38.240 --> 00:03:42.080 align:middle
より短く、より慣用句的に書くことができます。

00:03:42.240 --> 00:03:45.920 align:middle
このコードは Pharo ではよくあるものです。

00:03:46.080 --> 00:03:50.000 align:middle
セミコロン、つまりカスケードと
yourselfを

00:03:50.160 --> 00:03:52.400 align:middle
習得することはとても大切です。

00:03:53.080 --> 00:03:56.920 align:middle
このコースを終わるにあたって
次のことを覚えておいてください。

00:03:57.080 --> 00:04:00.480 align:middle
メソッドの中には
とてもシンプルでありながら

00:04:00.640 --> 00:04:03.240 align:middle
とてもパワフルで頻繁に使われるものが
あります。

00:04:05.200 --> 00:04:09.440 align:middle
カスケード、つまりセミコロンと
yourself メソッドは

00:04:09.600 --> 00:04:11.880 align:middle
とても頻繁に組み合わせられて使われます。

00:04:12.040 --> 00:04:15.240 align:middle
カスケードと yourself を使うことで
式全体の値が期待したものであることを

00:04:15.400 --> 00:04:17.960 align:middle
確実にすることができます。

